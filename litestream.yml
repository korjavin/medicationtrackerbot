# Litestream configuration for SQLite replication to Cloudflare R2
# Documentation: https://litestream.io/reference/config/

# Access credentials are provided via environment variables:
# - LITESTREAM_ACCESS_KEY_ID
# - LITESTREAM_SECRET_ACCESS_KEY

dbs:
  - path: /app/data/meds.db
    replicas:
      - type: s3
        bucket: ${R2_BUCKET}
        path: medtracker
        endpoint: ${R2_ENDPOINT}
        # Skip bucket verification (R2 doesn't support all S3 APIs)
        skip-verify: true
        # Sync interval - how often to sync WAL changes (default: 1s)
        sync-interval: 10s
        # Retention period for snapshots
        retention: 168h  # 7 days
        # How often to create full snapshots
        snapshot-interval: 24h
